---
layout: default
title: Avrae Quick Reference
---

<div class="hero-block">
  <h1>Avrae Command Reference</h1>
  <p>Fast search for syntax, aliases, and snippets.</p>
</div>

<div class="map-search-wrapper" style="max-width: 1200px; flex-direction: column; gap: 15px;">
  <input type="text" id="cmdSearchInput" placeholder="Search commands (e.g. 'attack', 'check', 'map')..." autofocus style="width: 100%;">

  <div class="filter-toggles" style="display: flex; gap: 10px; justify-content: center; width: 100%;">
    <button class="tool-btn active" onclick="setFilter('All')" id="btn-all">All</button>
    <button class="tool-btn" onclick="setFilter('Player')" id="btn-player">Player</button>
    <button class="tool-btn" onclick="setFilter('DM')" id="btn-dm">DM Only</button>
  </div>
</div>

<div class="avrae-list-container">
  <div class="avrae-header-row">
      <span>Command</span>
      <span>Syntax</span>
      <span>Example</span>
  </div>

  <div class="avrae-list" id="cmd-grid">
    
    {% assign grouped_commands = site.data.avrae_commands | group_by: 'category' | sort: 'name' %}
    
    {% for group in grouped_commands %}
      
      <button class="accordion-header active" onclick="toggleAccordion(this)">
          {{ group.name }}
      </button>

      <div class="accordion-content open">
        
        {% for cmd in group.items %}
          <div class="cmd-row" 
               data-search="{{ cmd.title }} {{ cmd.tags }} {{ cmd.note }}"
               data-type="{{ cmd.type | default: 'Both' }}">
            
              {% if cmd.note %}
                  <div class="cmd-note-text">{{ cmd.note }}</div>
              {% endif %}
            </div>

            <div class="col-code" data-label="Syntax">{{ cmd.syntax | escape }}</div>

            <div class="col-code" data-label="Example" style="color: var(--color-text);">{{ cmd.example | escape }}{% if cmd.image and cmd.image != "" %}<span class="demo-link-small" onclick="openModal('{{ cmd.image | relative_url }}')">ðŸŽ¥ Watch Demo</span>{% endif %}</div>

          </div>
        {% endfor %}
        
      </div>
    {% endfor %}
    
  </div>
</div>

<div id="demo-modal" class="modal-overlay" onclick="closeModal()">
  <div class="modal-content" onclick="event.stopPropagation()"> 
    <img id="modal-img" src="">
    <div style="text-align:center; margin-top:10px;">
        <button class="tool-btn" onclick="closeModal()">Close</button>
    </div>
  </div>
</div>

<style>
    @media (max-width: 800px) { .avrae-header-row { display: none; } }
</style>

<script>
  let currentFilter = 'All';

  const searchInput = document.getElementById('cmdSearchInput');
  const accordions = document.querySelectorAll('.accordion-content');
  const headers = document.querySelectorAll('.accordion-header');

  const btns = {
    'All': document.getElementById('btn-all'),
    'Player': document.getElementById('btn-player'),
    'DM': document.getElementById('btn-dm')
  };

  function toggleAccordion(btn) {
      btn.classList.toggle('active');
      const content = btn.nextElementSibling;
      content.classList.toggle('open');
  }

  function setFilter(type) {
    currentFilter = type;
    Object.values(btns).forEach(b => {
        b.style.background = 'var(--color-bg-controls)';
        b.style.color = 'var(--color-text)';
    });
    btns[type].style.background = 'var(--palette-brand-main)';
    btns[type].style.color = 'var(--palette-white)';
    runFilter();
  }

  searchInput.addEventListener('keyup', runFilter);

  function runFilter() {
    const filterText = searchInput.value.toLowerCase().trim();
    const terms = filterText.split(" ").filter(t => t.length > 0);
    const isSearching = (terms.length > 0 || currentFilter !== 'All');

    headers.forEach((header, index) => {
        const panel = accordions[index];
        const rows = panel.querySelectorAll('.cmd-row');
        let visibleCount = 0;

        rows.forEach(row => {
            const searchData = row.getAttribute('data-search').toLowerCase();
            const cardType = row.getAttribute('data-type'); 

            const textMatch = terms.every(term => searchData.includes(term));

            let typeMatch = true;
            if (currentFilter !== 'All') {
                if (cardType !== currentFilter && cardType !== 'Both') {
                    typeMatch = false;
                }
            }

            if (textMatch && typeMatch) {
                row.style.display = 'grid';
                visibleCount++;
            } else {
                row.style.display = 'none';
            }
        });

        if (visibleCount > 0) {
            header.style.display = 'flex';
            if (isSearching) {
                if (!panel.classList.contains('open')) {
                    panel.classList.add('open');
                    header.classList.add('active');
                }
            }
        } else {
            header.style.display = 'none';
        }
    });
  }

  const modal = document.getElementById('demo-modal');
  const modalImg = document.getElementById('modal-img');

  function openModal(imgSrc) {
    modalImg.src = imgSrc;
    modal.style.display = 'flex';
  }

  function closeModal() {
    modal.style.display = 'none';
    modalImg.src = "";
  }
  
  document.addEventListener('keydown', (e) => {
    if (e.key === "Escape") closeModal();
  });
  
  setFilter('All');
</script>